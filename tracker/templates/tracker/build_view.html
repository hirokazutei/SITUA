{% extends 'tracker/base.html' %}

{% block title %} Buildings {% endblock %}

{% block body %}

<h1>Building View</h1>
<h2>{{ building.name }} : {{ building.association }}</h2>
{% if building.image %}
{% load staticfiles %}
<img src={% static building.image.url %} alt="Building's Image" class="img-responsive img-rounded"\>
{% endif %}

{% if message %}
    <p><strong>{{ message }}</strong></p>
{% endif %}
    {% csrf_token %}
    <!--<div class="table-responsive">-->
    <table class="table table-hover">
        <tr>
            <th>Event No.</th>
            <th>Validity</th>
            <th>Processed</th>
            <th>Event Time</th>
            <th>Intensity</th>
            <th>Predominant Period</th>
            <th>Error Status</th>
            <th>Edit Event</th>
            <th>Process Data</th>
        </tr>
    {% for event in building.event_set.all %}
        <label for="event{{ forloop.counter }}">
            <tr class="Events">
                <td>{{ event.pk }}</td>
                {% if event.error %}
                    <td><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></td>
                {% else %}
                    <td><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></td>
                {% endif %}
                {% if event.processed %}
                <td><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></td>
                {% else %}
                <td><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></td>
                {% endif %}
                {% if event.error %}
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                {% else %}
                    <td>{{ event.event_time }}</td>
                    <td>{{ event.intensity }}</td>
                    {% if event.predominant_period > 0 %}
                        <td>{{ event.predominant_period }}</td>
                    {% else %}
                        <td>NOT PROCESSED</td>
                    {% endif %}
                {% endif %}
                <td><a href="{% url 'tracker:change_error' buildingpk=building.pk eventpk=event.pk %}"><button type="button"
                    class="btn btn-default">
                    Change</button></a></td>
                <td><a href="{% url 'tracker:event_edit' buildingpk=building.pk pk=event.pk %}"><button type="button"
                    class="btn btn-default">
                    Update</button></a></td>
                <td><a href="{% url 'tracker:process_data' buildingpk=building.pk eventpk=event.pk %}"><button type="button"
                    class="btn btn-default">
                    Process</button></a></td>
            </tr>
        </label><br>
    {% endfor %}
</table>
{% endblock %}
